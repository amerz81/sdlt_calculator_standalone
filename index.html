
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CANVI SDLT Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f1ef;
      color: #333;
    }
    .container {
      max-width: 720px;
      margin: 0 auto;
      background: #fff;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      border-top: 10px solid #91705D;
    }
    img.logo {
      max-width: 160px;
      display: block;
      margin: 0 auto 25px;
    }
    h1 {
      text-align: center;
      color: #91705D;
      font-weight: 600;
      margin-bottom: 30px;
    }
    label {
      display: block;
      margin-top: 20px;
      font-weight: 600;
      color: #5e514a;
    }
    .tooltip {
      display: inline-block;
      position: relative;
      cursor: pointer;
      margin-left: 5px;
      color: #91705D;
      font-weight: normal;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 240px;
      background-color: #333;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -120px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
    }
    button {
      margin-top: 30px;
      padding: 12px 25px;
      background: #91705D;
      color: #fff;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
      margin-right: 10px;
    }
    button:hover {
      background: #7a5e4f;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      background: #f1ebe7;
      border-left: 6px solid #91705D;
      border-radius: 8px;
    }
    .warn {
      color: #b33c3c;
      font-weight: bold;
      margin-top: 15px;
    }
    .disclaimer {
      margin-top: 40px;
      font-size: 0.9rem;
      color: #666;
      border-top: 1px solid #ddd;
      padding-top: 20px;
    }
    .pdf-button {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://www.canvigroup.com/web_Logo.png" alt="CANVI Group Logo" class="logo">
    <h1>SDLT Calculator</h1>
    <label for="price">Property Price (£)</label>
    <input type="number" id="price" min="0" required>

    <label for="ownership">Ownership Type
      <span class="tooltip">&#9432;
        <span class="tooltiptext">Choose 'Company' if the property is being purchased through a limited company or corporate entity.</span>
      </span>
    </label>
    <select id="ownership">
      <option value="individual">Individual</option>
      <option value="company">Company</option>
    </select>

    <label for="residency">Residency
      <span class="tooltip">&#9432;
        <span class="tooltiptext">Non-UK residents are subject to an additional 2% SDLT surcharge on residential property.</span>
      </span>
    </label>
    <select id="residency">
      <option value="uk">UK Resident</option>
      <option value="non-uk">Non-UK Resident</option>
    </select>

    <label for="propertyType">Property Type
      <span class="tooltip">&#9432;
        <span class="tooltiptext">Commercial properties have different SDLT bands and are not subject to residential surcharges.</span>
      </span>
    </label>
    <select id="propertyType">
      <option value="residential">Residential</option>
      <option value="commercial">Commercial</option>
    </select>

    <label for="firstTimeBuyer">First-Time Buyer?
      <span class="tooltip">&#9432;
        <span class="tooltiptext">First-Time Buyer relief applies only to residential properties up to £500,000. Above this, standard rates apply.</span>
      </span>
    </label>
    <select id="firstTimeBuyer">
      <option value="no">No</option>
      <option value="yes">Yes</option>
    </select>

    <label for="additional">Is this an additional property?
      <span class="tooltip">&#9432;
        <span class="tooltiptext">If you already own another residential property, a 3% SDLT surcharge applies to your purchase.</span>
      </span>
    </label>
    <select id="additional">
      <option value="no">No</option>
      <option value="yes">Yes</option>
    </select>

    <button onclick="calculateSDLT()">Calculate</button>
    <button onclick="resetForm()">Reset</button>
    <button class="pdf-button" onclick="downloadPDF()">Download PDF</button>

    <div class="result" id="output"></div>

    <div class="disclaimer">
      <strong>Disclaimer:</strong> This calculator provides an estimate of Stamp Duty Land Tax (SDLT) based on current published rates. It is for informational purposes only and does not constitute financial, legal, or tax advice. Please consult a professional adviser or HMRC for final tax assessments.
    </div>
  </div>

  <script>
    let breakdown = "";

    function calculateSDLT() {
      const price = parseFloat(document.getElementById('price').value);
      const ownership = document.getElementById('ownership').value;
      const residency = document.getElementById('residency').value;
      const propertyType = document.getElementById('propertyType').value;
      const firstTimeBuyer = document.getElementById('firstTimeBuyer').value;
      const additional = document.getElementById('additional').value;

      let sdlt = 0;
      let baseSDLT = 0;
      let addSurcharge = 0;
      let nonUKSurcharge = 0;
      let atedWarning = "";
      let ftbNote = "";

      if (propertyType === 'commercial') {
        if (price <= 150000) {
          baseSDLT = 0;
        } else if (price <= 250000) {
          baseSDLT = (price - 150000) * 0.02;
        } else {
          baseSDLT = (100000) * 0.02 + (price - 250000) * 0.05;
        }
      } else {
        if (ownership === 'company') {
          if (price > 500000) {
            atedWarning = "<p class='warn'>ATED may apply: annual charge starts at £4,400.</p>";
          }
          if (price <= 125000) {
            baseSDLT = price * 0.05;
          } else if (price <= 250000) {
            baseSDLT = (125000 * 0.05) + (price - 125000) * 0.07;
          } else if (price <= 925000) {
            baseSDLT = (125000 * 0.05) + (125000 * 0.07) + (price - 250000) * 0.10;
          } else {
            baseSDLT = (125000 * 0.05) + (125000 * 0.07) + (675000 * 0.10) + (price - 925000) * 0.15;
          }
        } else {
          if (firstTimeBuyer === 'yes') {
            if (price <= 300000) {
              baseSDLT = 0;
              ftbNote = "<p><strong>First-Time Buyer Relief Applied:</strong> 0% on up to £300,000.</p>";
            } else if (price <= 500000) {
              baseSDLT = (price - 300000) * 0.05;
              ftbNote = "<p><strong>First-Time Buyer Relief Applied:</strong> 0% on first £300,000, 5% on the rest.</p>";
            } else {
              ftbNote = "<p class='warn'>First-Time Buyer Relief does not apply as property price exceeds £500,000.</p>";
              if (price <= 125000) {
                baseSDLT = 0;
              } else if (price <= 250000) {
                baseSDLT = (price - 125000) * 0.02;
              } else if (price <= 925000) {
                baseSDLT = (125000 * 0.02) + (price - 250000) * 0.05;
              } else if (price <= 1500000) {
                baseSDLT = (125000 * 0.02) + (675000 * 0.05) + (price - 925000) * 0.10;
              } else {
                baseSDLT = (125000 * 0.02) + (675000 * 0.05) + (575000 * 0.10) + (price - 1500000) * 0.12;
              }
            }
          } else {
            if (price <= 125000) {
              baseSDLT = 0;
            } else if (price <= 250000) {
              baseSDLT = (price - 125000) * 0.02;
            } else if (price <= 925000) {
              baseSDLT = (125000 * 0.02) + (price - 250000) * 0.05;
            } else if (price <= 1500000) {
              baseSDLT = (125000 * 0.02) + (675000 * 0.05) + (price - 925000) * 0.10;
            } else {
              baseSDLT = (125000 * 0.02) + (675000 * 0.05) + (575000 * 0.10) + (price - 1500000) * 0.12;
            }
          }
          if (additional === 'yes') addSurcharge = price * 0.03;
        }
        if (residency === 'non-uk') nonUKSurcharge = price * 0.02;
      }

      sdlt = baseSDLT + addSurcharge + nonUKSurcharge;
      breakdown = `Property Price: £${price.toLocaleString()}
Base SDLT: £${baseSDLT.toFixed(2)}
`;
      if (addSurcharge > 0) breakdown += `+ 3% Additional Property Surcharge: £${addSurcharge.toFixed(2)}
`;
      if (nonUKSurcharge > 0) breakdown += `+ 2% Non-UK Resident Surcharge: £${nonUKSurcharge.toFixed(2)}
`;
      breakdown += `Total SDLT: £${sdlt.toFixed(2)}`;

      document.getElementById('output').innerHTML = `<h3>Total SDLT: £${sdlt.toLocaleString(undefined, {minimumFractionDigits: 2})}</h3>${ftbNote}<pre>${breakdown}</pre>` + atedWarning;
    }

    function resetForm() {
      document.getElementById('price').value = "";
      document.getElementById('ownership').value = "individual";
      document.getElementById('residency').value = "uk";
      document.getElementById('propertyType').value = "residential";
      document.getElementById('firstTimeBuyer').value = "no";
      document.getElementById('additional').value = "no";
      document.getElementById('output').innerHTML = "";
    }

    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFont("helvetica");
      doc.setFontSize(12);
      doc.text("CANVI SDLT Calculator

" + breakdown, 10, 20);
      doc.save("sdlt_breakdown.pdf");
    }
  </script>
</body>
</html>
